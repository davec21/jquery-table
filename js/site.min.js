/*!
 * Start Bootstrap - Agency v3.3.7+1 (http://startbootstrap.com/template-overviews/agency)
 * Copyright 2013-2017 Start Bootstrap
 * Licensed under MIT (https://github.com/BlackrockDigital/startbootstrap/blob/gh-pages/LICENSE)
 */
function init(){$.ajax({type:"get",url:"https://api.myjson.com/bins/o10zv",dataType:"json",success:function(a){console.log("Data fetched successfully. Begin parse.",a),buildTable(a),buildModal(a)}})}function buildTable(a){var t=$("#edit-table > tbody");jsonData=a;var n="<tr>";a.columns.forEach(function(a){n+="<th>"+a.name+"</th>"}),n+="</tr>",t.html(n);for(var o=0;o<a.data.length;o++)addRowToTable(o)}function buildModal(a){for(var t=$("#myModal .modal-body"),n="",o=0;o<a.columns.length;o++)n+='<div class="form-group">',n+='<label for="exampleInputEmail1">'+a.columns[o].name+"</label>",n+='<input type="email" class="form-control"  id="dval-'+o+'"></div>';t.html(n)}function addRowToTable(a){for(var t=$("#edit-table > tbody"),n='<tr id="row-'+a+'">',o=(jsonData.data[a],0);o<jsonData.columns.length;o++)n+="<td>"+createTableCell(o,a)+"</td>";n+="<td>",n+='<button class="btn btn-small btn-primary" onclick="editRow('+a+')">Edit</button> ',n+='<button class="btn btn-small btn-danger" onclick="deleteRow('+a+')">Delete</button> ',n+="</td></tr>",t.append(n)}function createTableCell(a,t){var n=jsonData.columns[a],o=jsonData.data[t],e=o[a];e||(e="");var l='<input data-col="'+a+'" data-row="'+t+'" class="form-control" onkeydown=keyDown(event) onblur=endEdit(this) type="';switch(n.datatype){case"string":l+='text" value="'+e+'"';break;case"json":""!==e&&(e=JSON.stringify(e).replace(/"/g,"'")),l+='text" value="'+e+'"';break;case"number":l+='number" value="'+e+'"';break;case"date":l+='date" value="'+e+'"'}return l+='" data-old="'+e+'"></input>'}function keyDown(a){"Escape"===a.key&&cancelEdit(a.target)}function addNewRow(){var a=jsonData.data.push(new Array(jsonData.columns.length));addRowToTable(a-1)}function deleteRow(a){jsonData.data.splice(a,1),buildTable(jsonData)}function editRow(a){var t=0;$("#row-"+a);$("#row-"+a+"> td > input").each(function(){$("#dval-"+t++).val($(this).val())}),$("#myModal").modal("show")}function endRowEdit(){}function cancelRowEdit(){}function endEdit(a){console.log("Err");var t=$(a),n=jsonData.columns[t.data("col")],o=jsonData.data[t.data("row")],e=t.data("old"),l=t.val();return e===l||validateInput(l,o,n)?(t.css("border",""),o[n]=l,void t.attr("data-old",l)):(t.css("border","2px solid red"),void t.focus())}function cancelEdit(a){var t=$(a);t.val(t.data("old"))}function validateInput(newValue,row,column){return column.validationFunc?(eval("var validate = "+column.validationFunc),validate(newValue)):"json"!==column.datatype||validateJsonInput(newValue.replace(/'/g,'"'))}function validateJsonInput(a){if(!a)return!1;try{JSON.parse(a);return!0}catch(t){return console.log(t),!1}}var jsonData;